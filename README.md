# `sftp-protocol` Client CLI Documentation

This document describes the usage of the `sftp-protocol client` command-line interface, which allows performing SFTP operations like authentication, file uploads, downloads, directory creation, and listing against a compatible SFTP server.

## Overview

The client operates by establishing a new connection to the server for each command executed (e.g., `upload`, `download`, `ls`). It authenticates the connection using the provided credentials, performs the requested action, and then closes the connection. There is no persistent session maintained between separate command invocations.

## Global Client Options

These options apply to all `client` subcommands:

*   `-s, --server <host:port>`
    *   Specifies the address and port of the SFTP server.
    *   *Default:* `127.0.0.1:2022`

## Authentication

All client operations that interact with the server (upload, download, mkdir, ls, login) require authentication. You must always provide a username. For the authentication itself, you must provide *either* a password *or* a path to a private key file (identity file).

*   `-u, --username <username>`
    *   **(Required)** The username to authenticate with on the SFTP server.
*   `-p, --password <password>`
    *   The password associated with the username. Use this OR `--identity-file`.
*   `-i, --identity-file <path/to/private_key>`
    *   The path to the PEM-encoded private key file (e.g., generated by `ssh-keygen`) for public key authentication. The corresponding public key must be authorized for the specified username on the server. Use this OR `--password`.

**Note:** If both `--password` and `--identity-file` are provided, the `--identity-file` will be prioritized for authentication.

## Commands

### `sftp-protocol client login`

Tests connectivity and authentication with the SFTP server using either username/password or public key authentication. This command is primarily for verifying credentials and server reachability. It does **not** establish a persistent session for subsequent commands.

**Usage:**

```bash
sftp-protocol client login [flags]
```

**Flags:**

*   `-u, --username <username>`: (Required) Username for authentication.
*   `-p, --password <password>`: Password for authentication (optional if `-i` provided).
*   `-i, --identity-file <path>`: Path to private key file for auth (optional if `-p` provided).
*   `-s, --server <host:port>`: Server address (defaults to `127.0.0.1:2022`).

**Examples:**

```bash
# Test login using password
sftp-protocol client login -s sftp.example.com:2022 -u myuser -p mysecret

# Test login using public key
sftp-protocol client login -s 127.0.0.1:2022 -u myuser -i ~/.ssh/id_ecdsa
```

---

### `sftp-protocol client upload`

Connects, authenticates, uploads a local file to the specified remote path on the SFTP server, and disconnects.

**Usage:**

```bash
sftp-protocol client upload [flags] <local_file> <remote_path>
```

**Arguments:**

*   `<local_file>`: (Required) The path to the local file to upload.
*   `<remote_path>`: (Required) The destination path (including filename) on the remote server.

**Flags:**

*   `-u, --username <username>`: (Required) Username for authentication.
*   `-p, --password <password>`: Password for authentication (optional if `-i` provided).
*   `-i, --identity-file <path>`: Path to private key file for auth (optional if `-p` provided).
*   `-s, --server <host:port>`: Server address (defaults to `127.0.0.1:2022`).

**Examples:**

```bash
# Upload report.txt using password authentication
sftp-protocol client upload -u myuser -p mysecret report.txt /data/reports/report_final.txt

# Upload data.csv using public key authentication to the user's home directory
sftp-protocol client upload -s sftp.example.com -u myuser -i ~/.ssh/id_ecdsa data.csv data.csv
```

---

### `sftp-protocol client download`

Connects, authenticates, downloads a remote file to the specified local path, and disconnects.

**Usage:**

```bash
sftp-protocol client download [flags] <remote_path> <local_path>
```

**Arguments:**

*   `<remote_path>`: (Required) The path to the file on the remote server to download.
*   `<local_path>`: (Required) The destination path (including filename) on the local machine.

**Flags:**

*   `-u, --username <username>`: (Required) Username for authentication.
*   `-p, --password <password>`: Password for authentication (optional if `-i` provided).
*   `-i, --identity-file <path>`: Path to private key file for auth (optional if `-p` provided).
*   `-s, --server <host:port>`: Server address (defaults to `127.0.0.1:2022`).

**Examples:**

```bash
# Download a log file using password authentication
sftp-protocol client download -u myuser -p mysecret /logs/app_2023-10-27.log ./downloaded_app.log

# Download a config file using public key authentication
sftp-protocol client download -u myuser -i ~/.ssh/id_ecdsa config.json ./my_config.json
```

---

### `sftp-protocol client mkdir`

Connects, authenticates, creates a new directory at the specified remote path, and disconnects.

**Usage:**

```bash
sftp-protocol client mkdir [flags] <remote_path>
```

**Arguments:**

*   `<remote_path>`: (Required) The path of the directory to create on the remote server.

**Flags:**

*   `-u, --username <username>`: (Required) Username for authentication.
*   `-p, --password <password>`: Password for authentication (optional if `-i` provided).
*   `-i, --identity-file <path>`: Path to private key file for auth (optional if `-p` provided).
*   `-s, --server <host:port>`: Server address (defaults to `127.0.0.1:2022`).

**Examples:**

```bash
# Create a directory using password authentication
sftp-protocol client mkdir -u myuser -p mysecret /data/new_project

# Create a directory using public key authentication
sftp-protocol client mkdir -u myuser -i ~/.ssh/id_ecdsa backups
```

---

### `sftp-protocol client ls`

Connects, authenticates, lists the files and directories within the specified remote path, and disconnects.

**Usage:**

```bash
sftp-protocol client ls [flags] <remote_path>
```

**Arguments:**

*   `<remote_path>`: (Required) The path of the directory to list on the remote server. Use `.` to list the user's default directory (usually the home directory).

**Flags:**

*   `-u, --username <username>`: (Required) Username for authentication.
*   `-p, --password <password>`: Password for authentication (optional if `-i` provided).
*   `-i, --identity-file <path>`: Path to private key file for auth (optional if `-p` provided).
*   `-s, --server <host:port>`: Server address (defaults to `127.0.0.1:2022`).

**Examples:**

```bash
# List the contents of the default directory using password
sftp-protocol client ls -u myuser -p mysecret .

# List the contents of /data/images using public key
sftp-protocol client ls -u myuser -i ~/.ssh/id_ecdsa /data/images
```
